<style>
    /*Container for buttons in the activity container*/
    .activity-functions {
        position: relative;
        width: 100%;
        margin-bottom: 0px;
        padding-left: 0;
    }

    #activity-progress-input {
      margin-top: 10px;
    }

    .experiment-game-container {
      position: relative;
      border: 1px solid #eee;
      padding: 5px;
    }

    .btn-youtube{
        background-image: <% asset_path('youtube.png') %>;
    }

    #stats {
  float: right;
  padding-left: 15px;
  padding-right: 15px;
  padding-bottom: 9px;
  padding-top: 9px;
  box-shadow: rgba(0, 0, 0, 0.2382) 0px 1px 5px;
  background-color: #dff0d8;
  border-radius: 70px;
  color: green;
    font-size: 135%;
    }

    #stats p {
      margin-bottom: 0;
    }
    #stats span {
      color: green;
    }
</style>

<div class="activity-content-wrap">
  <div class="container activity-functions">
    <div align="center">
      <button class="btn btn-danger" onclick="removeExperiment()"> Abort </button>

      <a class="btn btn-link" target='_blank' href='http://www.echalk.co.uk/amusements/Games/Tetrominoes/tetrominoes.html'>
        <img src="https://cocosci.berkeley.edu/mturk/falk/writingTaskRating/img/tetris.jpg" width="75px"/>
      </a>

      <a class="btn btn-link" target='_blank' href='http://www.youtube.com'>
        <img src="https://cocosci.berkeley.edu/mturk/falk/writingTaskRating/img/youtube.png" width="75px"/>
      </a>

      <a class="btn btn-link" target='_blank' href='http://www.reddit.com'>
        <img src="http://cocosci.berkeley.edu/mturk/falk/writingTaskRating/img/reddit.jpg" width="75px"/>
      </a>

      <a class="btn btn-link" target='_blank' href='http://news.google.com'>
        <img src="http://cocosci.berkeley.edu/mturk/falk/writingTaskRating/img/news.png" width="75px"/>
      </a>
    </div>

    <span style="margin-top: 10px; font-size:200%;">
      <strong>
        Writing Assignment
        <span class='activity-number'></span>
      </strong>
    </span>

    <% if current_user.experimental_condition == "points condition" || current_user.experimental_condition == "constant points" %>
      <div id="stats">
        <p><strong>Level: </strong> <span> <%= current_user.level %></span></p>
        <p><strong>Points: </strong> <span> <%= current_user.score%> </span> </p>
      </div>
    <% elsif current_user.experimental_condition == "monetary condition" %>
      <div id="stats">

        <p><strong>Level: </strong> <span> <%= current_user.level %></span></p>
        <p><strong>Money: </strong> <span> $<%= current_user.score.to_f / 10%>0 </span> </p>
      </div>
    <% end %>
  </div>

  <div class="experiment-game-container">
    <%= form_for current_user.answers.build, html: { remote: true } do |f| %>
      <%= f.hidden_field :activity_id %>
      <div class="game-content" style="width: 100%; height: 100%; overflow: hidden;">
        <h4 style="text-align:center; line-height: 150px;">
          Please select a task to work on!
        </h4>
      </div>
      <div class='input-controls'>
        <div class='warning'>
          Your text should be original and of the highest quality, and you have to write at least 100 words. If you copy from a different source, then your submission will be rejected.
        </div>

        <%= f.text_area :answer, rows: 8, style: 'width:80%; margin:0 10%;' %>
        <%= f.submit 'Submit', style: 'display:block; margin:0 auto;' %>
      </div>
    <% end %>

    <div class='hint' style='display:none' id='success-message'>
      Thank you! Your response has been recorded and will be graded when you submit the HIT.
      <br>
      The code for checking off this writing assignment from your todo list is <strong><span id="completion-code"></span></strong>.
      <br>
      Please copy this code and paste it into the text box below the assignment. A green button with the caption <strong>Finish Activity</strong> will appear at the bottom of the page. Please make sure to click it to check off the task from your todo list.
      <br>
      If your response does not meet the requirements of this assignments then you will lose some or all of your bonus.
    </div>

    <div class='warning' style='display:none' id='fail-message'>
      <b>Your response is too short. You have to elaborate your response further before your can submit this assignment.</b>
      <button class='retry-button'>Okay, I will revise my response.</button>
    </div>
  </div>

  <div class="row code-confirmation" style="padding:5px; padding-left:15px; display:none" >
    <form class="form-inline" role="form">
      <div class="form-group">
        <input type="password" class="form-control" id="activity-progress-input" placeholder="Enter Code Here" style="padding: 5px; width: 90%;">
      </div>
    </form>
  </div>
</div>

<script>
  $(document).ready(function() {
    $(window).keydown(function(event) {
      if (event.keyCode == 13) {
        event.preventDefault();
        return false;
      }
    });
  });

  function removeExperiment() {
    var currentId = document.getElementsByClassName('tab-pane active')[0].id;
    $(".game-content").html("<h4 style='text-align:center; margin-top: 100px;''> Task Aborted. <br/> Please select a new task and press Start! </h4>");
    $.get('/abort_activity/' + String(currentId));
  }
</script>
